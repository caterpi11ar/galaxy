# Galaxy 像素风格星球小游戏 - UI 开发任务清单

## 项目概述
"Galaxy" - 多人在线像素风格星球互动游戏
- **技术架构**: Next.js 14+ 全栈开发，重点关注 UI 组件开发
- **设计风格**: 像素风格（Pixel Art）+ 现代 Web 设计， 参考 https://www.pixilart.com/
- **核心页面**: 主界面（宇宙视图）、排行榜、星球绘制工具
- **UI 技术栈**: React 19 + TypeScript + Tailwind CSS + React Konva/Konva.js + React-Bits 动画库

## 第一阶段：UI 基础设施搭建

### 1. 像素风格设计系统
- [x] 1.1 像素风格调色板定义（深色太空主题）
- [x] 1.2 等宽字体系统配置（Courier New）
- [x] 1.3 像素完美渲染设置（image-rendering: pixelated）
- [x] 1.4 动画效果集成和定制
  - [x] 背景动画（星空、粒子效果）
  - [x] 文字动画（打字机效果）
  - [x] 过渡动画适配像素风格
- [x] 1.5 响应式断点和布局规则

### 2. 核心 UI 组件库
- [x] 2.1 像素风格按钮组件（悬停、点击动画）
- [x] 2.2 像素风格输入框组件（聚焦、边框动画）
- [x] 2.3 像素风格模态框组件（进入/退出、背景模糊）
- [x] 2.4 像素风格导航栏组件（过渡、响应式菜单）
- [ ] 2.5 像素风格卡片组件（悬停、点击、阴影边框）
- [ ] 2.6 像素风格徽章和标签组件（数字滚动、状态切换）

### 3. 图标和视觉资源
- [x] 3.1 像素风格图标集（悬停、点击、状态切换）
- [x] 3.2 星球相关图标（旋转、脉冲、闪烁、轨道动画）
- [x] 3.3 用户界面图标（变形、状态指示动画）
- [x] 3.4 像素风格加载动画（进度条、旋转器、星球主题）
- [x] 3.5 背景纹理和装饰元素（星空粒子、流星、几何图形）

## 第二阶段：主要页面 UI 开发

### 4. 主界面 (Universe View) UI 开发 (React Konva + React-Bits 增强)
- [x] 4.1 宇宙画布组件架构设计
  - [x] React Konva 画布渲染系统 + React-Bits 背景动画
  - [x] Konva.js 星球绘制和交互系统
  - [x] 缩放和平移控制 (Konva Stage) + 平滑过渡动画
  - [x] 集成 React-Bits 粒子系统作为 Konva Layer 背景
- [x] 4.2 顶部导航栏实现
  - [x] Galaxy logo 和标题 + React-Bits 文字动画
  - [x] 登录状态显示 + 状态切换动画
  - [ ] 排行榜入口按钮 + 悬停动画效果
- [x] 4.3 底部控制栏实现
  - [x] 缩放控制按钮 + React-Bits 交互动画
  - [ ] "我的星球"导航 + 路径过渡效果
  - [ ] 在线统计信息 + 数字滚动动画
- [x] 4.4 星球详情模态框
  - [x] 星球信息展示 + React-Bits 卡片动画
  - [ ] 点赞/踩交互 + 反馈动画效果
  - [ ] 权限状态处理 + 状态指示动画
- [x] 4.5 移动端适配优化
  - [x] 响应式动画适配
  - [x] 触控友好的 React-Bits 组件调整
- [x] 4.6 性能优化和渲染优化
  - [x] React-Bits 动画性能优化
  - [x] 动画帧率控制和内存管理

### 5. 排行榜页面 (Leaderboard) UI 开发 (React-Bits 增强)
- [ ] 5.1 排行榜页面布局架构
  - [ ] 集成 React-Bits 页面进入动画
  - [ ] 添加背景渐变和装饰动画
- [ ] 5.2 多标签页导航实现
  - [ ] 星球评分榜 + React-Bits 标签切换动画
  - [ ] 玩家活跃榜 + 数据更新动画效果
  - [ ] 今日新星榜 + 新项目高亮动画
  - [ ] 历史强者榜 + 排名变化动画
- [ ] 5.3 排行榜项目组件
  - [ ] 排名徽章设计（金银铜）+ React-Bits 闪烁效果
  - [ ] 星球/玩家信息展示 + 悬停动画
  - [ ] 趋势指标显示 + React-Bits 数值动画
- [ ] 5.4 统计面板实现
  - [ ] 集成 React-Bits 图表动画效果
  - [ ] 添加数据可视化动画
- [ ] 5.5 移动端排行榜优化
  - [ ] 响应式 React-Bits 组件适配
- [ ] 5.6 无限滚动和基于坐标的分页
  - [ ] 集成 React-Bits 加载动画
  - [ ] 添加内容出现动画效果

### 6. 绘制星球页面 (Planet Creator) UI 开发 (React Konva 增强)
- [ ] 6.1 绘制画布核心实现
  - [ ] React Konva 像素绘制引擎 + 画布动画
  - [ ] Konva.js 实时预览功能 + 平滑过渡效果
  - [ ] 撤销/重做历史管理 (Konva History) + 操作反馈动画
- [ ] 6.2 绘制工具栏设计
  - [ ] 画笔工具组件 + React-Bits 工具选择动画
  - [ ] 形状工具组件 + 工具提示动画
  - [ ] 橡皮擦工具组件 + 擦除效果动画
  - [ ] 图案工具组件 + 预览动画效果
- [ ] 6.3 颜色选择器实现
  - [ ] 像素艺术调色板 + React-Bits 颜色切换动画
  - [ ] 自定义颜色选择器 + 色彩过渡效果
  - [ ] 当前颜色显示 + 颜色变化动画
- [ ] 6.4 星球属性编辑器
  - [ ] 星球名称输入 + React-Bits 输入框动画
  - [ ] 星球描述输入 + 字符计数动画
  - [ ] 字符限制和验证 + 错误提示动画
- [ ] 6.5 预设图案库实现
  - [ ] 集成 React-Bits 图案预览动画
  - [ ] 添加图案选择和应用动画
- [ ] 6.6 移动端绘制工具适配
  - [ ] 响应式工具栏动画
  - [ ] 触控优化的 React-Bits 组件
- [ ] 6.7 触控设备手势支持
  - [ ] 手势反馈动画
  - [ ] 触控状态指示动画

## 第三阶段：交互体验优化

### 7. 用户体验增强 (React-Bits 全面集成)
- [ ] 7.1 页面间过渡动画
  - [ ] 使用 React-Bits 页面切换动画
  - [ ] 集成路由过渡效果
- [ ] 7.2 微交互反馈设计
  - [ ] React-Bits 悬停和点击反馈
  - [ ] 集成触觉反馈动画模拟
- [ ] 7.3 加载状态和骨架屏
  - [ ] React-Bits 加载动画组件
  - [ ] 星球主题骨架屏设计
- [ ] 7.4 错误状态页面设计
  - [ ] React-Bits 错误动画效果
  - [ ] 404 页面星球主题动画
- [ ] 7.5 空数据状态设计
  - [ ] React-Bits 空状态动画
  - [ ] 宇宙主题空数据展示

### 8. 认证相关 UI 组件 (React-Bits 动画)
- [x] 8.1 登录模态框设计
  - [x] React-Bits 模态框进入/退出动画
  - [x] 登录表单动画效果
- [x] 8.2 OAuth 提供商按钮
  - [x] React-Bits 按钮悬停动画
  - [x] 社交登录图标动画
- [x] 8.3 用户资料展示组件
  - [x] React-Bits 头像动画效果
  - [x] 用户信息展示动画
- [ ] 8.4 登出确认对话框
  - [ ] React-Bits 确认框动画
  - [ ] 操作反馈动画
- [x] 8.5 游客模式提示组件
  - [x] React-Bits 提示动画效果
  - [x] 引导操作动画

### 9. 响应式设计完善
- [x] 9.1 移动端主界面优化
  - [x] 触控友好的缩放控制
  - [x] 移动端导航重构
- [x] 9.2 平板端界面适配
- [ ] 9.3 大屏幕显示优化
- [ ] 9.4 横屏/竖屏适配
- [ ] 9.5 PWA 界面支持

### 10. 可访问性和性能
- [ ] 10.1 键盘导航支持
- [ ] 10.2 屏幕阅读器支持
- [ ] 10.3 高对比度模式
- [ ] 10.4 Konva.js 渲染性能优化
- [ ] 10.5 图像和资源懒加载
- [ ] 10.6 减少重渲染优化

## React Konva 集成策略

### React Konva 核心功能规划

#### 主要画布功能 (React Konva)：
1. **宇宙视图画布**
   - Konva Stage 作为主画布容器
   - Layer 管理：背景层、星球层、UI层
   - 高性能图形渲染和缓存
   - 平滑缩放和平移交互

2. **星球绘制系统**
   - 像素级精确绘制工具
   - 实时画笔、形状、图案工具
   - 撤销/重做历史管理
   - 图层管理和合成

3. **交互式元素 (跨平台)**
   - 星球拖拽和选择 (鼠标 + 触摸)
   - 点击热区检测 (精确点击 + 触摸友好)
   - 悬停效果和提示 (PC 悬停 + 移动长按)
   - 手势支持 (滚轮缩放 + 双指缩放)

4. **性能优化特性**
   - 智能重绘区域检测
   - 对象池和缓存管理
   - 视口裁剪优化
   - 帧率控制和节流

### 技术集成建议

#### 安装依赖：
```bash
# React Konva 核心库
pnpm add konva react-konva
pnpm add -D @types/konva
```

#### 像素风格适配：
- 禁用 Konva 的默认抗锯齿：`imageSmoothingEnabled: false`
- 使用整数坐标确保像素完美渲染
- 实现像素对齐的图形绘制
- 集成像素艺术调色板限制

#### 与 React-Bits 协调：
- Konva 处理画布内的交互和渲染
- React-Bits 处理 UI 层的动画效果
- 避免重复的动画系统冲突
- 优化渲染管道和帧率同步

#### 跨平台事件处理：
- 统一鼠标和触摸事件处理器
- 自动检测设备类型并适配交互方式
- PC 端：`mousedown`, `mousemove`, `mouseup`, `wheel`, `contextmenu`
- 移动端：`touchstart`, `touchmove`, `touchend`, `gesturestart`, `gesturechange`
- 通用：`pointerdown`, `pointermove`, `pointerup` (现代浏览器优先)

#### 具体交互映射示例：
- **缩放控制**：
  - PC：鼠标滚轮上下滚动 (`wheel` 事件)
  - 移动端：双指捏合/展开手势 (`touchstart` + 多点触控)
- **拖拽平移**：
  - PC：鼠标左键拖拽 (`mousedown` + `mousemove`)
  - 移动端：单指拖拽 (`touchmove`)
- **右键菜单**：
  - PC：鼠标右键点击 (`contextmenu` 事件)
  - 移动端：长按手势 (`touchstart` + 计时器)
- **悬停效果**：
  - PC：鼠标悬停 (`mouseenter`/`mouseleave`)
  - 移动端：点击高亮或长按预览

## React-Bits 集成策略

### React-Bits 组件使用规划

#### 推荐使用的 React-Bits 组件类型：
1. **背景和装饰动画**
   - 星空粒子效果背景
   - 几何图形装饰动画
   - 渐变和光影效果

2. **交互动画组件**
   - 按钮悬停和点击动画
   - 卡片翻转和缩放效果
   - 输入框聚焦动画

3. **文字和数字动画**
   - 打字机效果文字
   - 数字滚动和计数动画
   - 文字出现和消失效果

4. **加载和状态动画**
   - 各种样式的加载动画
   - 进度条和进度环
   - 状态切换动画

5. **页面过渡动画**
   - 页面切换过渡效果
   - 模态框进入/退出动画
   - 内容展开/折叠动画

### 技术集成建议

#### 组件安装和使用流程：
```bash
# 使用 jsrepo 安装具体组件
npx jsrepo add [component-name]
```

#### 像素风格适配：
- 将 React-Bits 动画与像素艺术风格相结合
- 调整动画时间和缓动函数适配像素风格
- 保持锐利边缘和像素完美的渲染
- 使用受限的颜色调色板

#### 性能优化：
- 合理控制同时播放的动画数量
- 使用 React-Bits 的性能优化选项
- 在低性能设备上降级动画效果
- 提供动画开关选项

## Galaxy UI 开发预期产出

✅ **完整的像素风格设计系统 (集成 React-Bits)**
✅ **宇宙画布核心功能完整实现 (React Konva + 像素风格)**
✅ **认证系统 UI 组件完整实现 (NextAuth.js 集成)**
✅ **可重用的 UI 组件库 (React-Bits 动画)**
✅ **响应式和移动端适配 (跨平台交互一致性)**
✅ **高性能 React Konva 绘制引擎 (SSR 优化)**
✅ **优秀的用户体验设计 (加载优化 + 视觉一致性)**

## 不包括的内容（后续开发阶段）

❌ 后端 API 集成和数据管理
❌ 实时通信功能实现
❌ 用户认证逻辑实现
❌ 数据库操作和持久化
❌ 服务端渲染优化
❌ 部署和生产环境配置

## UI 设计原则

### 像素艺术美学
- **颜色限制**: 使用有限的调色板，保持像素艺术风格
- **锐利边缘**: 避免抗锯齿，保持像素完美的边缘
- **等宽字体**: 统一使用 Courier New 等等宽字体
- **简洁图标**: 使用简单的几何图形和表情符号

### 跨平台交互一致性 (PC + 移动端)
- **统一事件处理**: 所有交互事件必须同时支持鼠标和触摸操作
- **交互映射策略**:
  - 缩放：PC 滚轮上下 ↔ 移动端双指捏合
  - 平移：PC 鼠标拖拽 ↔ 移动端单指滑动
  - 菜单：PC 右键点击 ↔ 移动端长按手势
  - 悬停：PC 鼠标悬停 ↔ 移动端点击高亮
- **PC 端优化**: 鼠标悬停效果、右键菜单、键盘快捷键、精确点击
- **移动端优化**: 触摸手势、长按操作、触觉反馈、手指友好的触摸目标
- **自适应交互**: 根据设备类型自动调整交互方式和反馈强度
- **无障碍支持**: 键盘导航、屏幕阅读器、高对比度模式在所有平台一致

### 现代 Web 交互 (React-Bits 增强)
- **直观操作**: 拖拽、缩放、点击等自然交互 + React-Bits 反馈动画
- **即时反馈**: 悬停效果、状态变化提示 + 丰富的视觉反馈
- **流畅动画**: React-Bits 专业动画库提供的高品质过渡效果
- **响应式设计**: 适配各种设备和屏幕尺寸 + 响应式动画适配

### 性能优先 (React Konva + React-Bits 优化)
- **Konva 优化**: 智能重绘和渲染优化 + Layer 管理 + 动画性能调优
- **组件复用**: 减少不必要的重新渲染 + React-Bits 组件复用
- **资源管理**: 高效的图像和数据处理 + Konva 缓存 + 动画资源管理
- **加载策略**: 分步加载和懒加载技术 + 动画按需加载

## 最近完成的重要功能 (2025-08-31)

### ✅ 宇宙画布系统核心实现
- **UniverseCanvas.tsx**: React Konva 主画布组件，支持星球交互、缩放平移
- **UniverseLoadingScreen.tsx**: 全屏像素风格加载界面，统一品牌视觉
- **ClientOnlyCanvas.tsx**: SSR 兼容性解决方案，动态加载画布组件
- **各种子组件**: StarField、Nebulae、PlanetComponent、ZoomControls 等

### ✅ 认证系统 UI 完整实现
- **NextAuthLoginModal.tsx**: 完整的登录模态框，支持 GitHub/Google OAuth
- **GameHeader.tsx**: 集成认证状态的游戏头部组件
- **认证状态管理**: 登录/登出状态切换，用户信息显示
- **错误处理**: 登录失败处理和用户友好的错误提示

### ✅ 品牌视觉一致性优化
- **Galaxy Logo 统一**: 所有组件使用一致的 galaxy.svg 设计
- **像素风格设计系统**: 完整的颜色系统、动画效果、字体配置
- **布局优化**: 居中对齐、合理间距、响应式适配

### ✅ 响应式设计完善 (移动端适配)
- **GameHeader 响应式**: 移动端 Logo 缩小，版本号隐藏，按钮图标化
- **ZoomControls 触控优化**: 移动端按钮从 8x8 增大到 10x10，添加触控反馈
- **NextAuthLoginModal 适配**: 移动端间距优化，触控区域增大到 48px
- **页面布局优化**: 响应式 padding，移动端 16px，桌面端 32px

### ✅ 跨平台手势支持系统
- **useGestures Hook**: 统一处理 PC 和移动端手势交互
- **设备检测**: useDeviceType 自动识别设备类型并适配交互方式
- **手势映射**: 拖拽、缩放、长按等手势的跨平台统一处理
- **拖拽灵敏度优化**: 动态阻尼系统，根据手势速度调整响应度

### ✅ 技术架构优化
- **SSR 问题解决**: 解决 React Konva 服务端渲染兼容性
- **构建优化**: Next.js webpack 配置优化，支持画布库
- **环境配置**: NextAuth.js 完整配置，支持多种登录方式
- **类型安全**: 完整的 TypeScript 类型定义和检查
- **依赖管理**: 集成 @use-gesture/react 手势支持库

---

*本 UI 开发任务清单将根据开发进度持续更新*
